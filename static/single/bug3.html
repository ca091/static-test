<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="renderer" content="webkit">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="format-detection" content="telephone=no, email=no"/>
  <meta name="description" content=""/>
  <meta name="keywords" content=""/>
  <meta name="robots" content="index,follow"/>
  <title></title>
  <style>
    /*html, body{*/
    /*height: 100%;*/
    /*}*/
    body {
      margin: 0;
    }
    #app {
      max-width: 640px;
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: vertical;
      -webkit-box-direction: normal;
      -ms-flex-direction: column;
      flex-direction: column;
    }
    .nav-bar {
      position: relative;
      height: 64px;
      text-align: center;
      background: #fff;
    }
    .body-with-nav {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: vertical;
      -webkit-box-direction: normal;
      -ms-flex-direction: column;
      flex-direction: column;
    }
    .body, .body-with-nav {
      -webkit-box-flex: 1;
      -ms-flex: 1;
      flex: 1;
      overflow: scroll;
    }
    .fixed {
      position: fixed;
    }
  </style>
</head>
<body>
<div id="app">
  <div class="body-with-nav">
    <div class="nav-bar">
      <h2>title</h2>
    </div>
    <div class="body trans">
      <p>1</p>
      <p>22</p>
      <p>333</p>
      <p>4</p>
      <p>5</p>
      <p>6</p>
      <p>7</p>
      <p>8</p>
      <p>9</p>
      <p>1</p>
      <p>2</p>
      <p>333</p>
      <p>4</p>
      <p>5</p>
      <p>6</p>
      <p>7</p>
      <p>8</p>
      <p>9</p>
      <p>1</p>
    </div>
    <div class="box-input">
      <p>please put some text</p>
      <input type="text" placeholder="input">
    </div>
  </div>
</div>
<script>
  var startY
  var input = document.querySelector('input')
  var trans = document.querySelector('.trans')
  var nav = document.querySelector('.nav-bar')
  var foot = document.querySelector('.box-input')

  input.addEventListener('click', function (event) {
    var tar = this
    setTimeout(function () {
      var st = document.body.scrollTop
      document.body.scrollTop = 0
//            document.body.scrollIntoView()
      tar.style.position = 'fixed'
      tar.style.bottom = st + 'px'
    }, 100)
  })
  input.addEventListener('blur', function () {
    var tar = this
    tar.style.position = 'static'
  })
  nav.addEventListener('touchmove', function (e) {
    e.preventDefault()
  })
  foot.addEventListener('touchmove', function (e) {
    e.preventDefault()
  })
  trans.addEventListener('touchstart', function (e) {
    startY = e.touches[0].clientY
  })
  trans.addEventListener('touchmove', function (e) {
    // 高位表示向上滚动
    // 底位表示向下滚动
    // 1容许 0禁止
    var status = '11'
    var ele = this
    var currentY = e.touches[0].clientY
    if (ele.scrollTop === 0) {
      // 如果内容小于容器则同时禁止上下滚动
      status = ele.offsetHeight >= ele.scrollHeight ? '00' : '01'
    } else if (ele.scrollTop + ele.offsetHeight >= ele.scrollHeight) {
      // 已经滚到底部了只能向上滚动
      status = '10'
    }
    if (status !== '11') {
      // 判断当前的滚动方向
      var direction = currentY - startY > 0 ? '10' : '01'
      // 操作方向和当前允许状态求与运算，运算结果为0，就说明不允许该方向滚动，则禁止默认事件，阻止滚动
      if (!(parseInt(status, 2) & parseInt(direction, 2))) {
        e.preventDefault()
      }
    }
  })

</script>
</body>
</html>
